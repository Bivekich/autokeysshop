---
import Usluga from './Usluga.astro';
import { urlFor } from '../sanityclient'

const { uslugi } = Astro.props;

let uslugaElements = [];

// console.log(uslugi)

if (Object.keys(uslugi).length > 0) {
  for (let i = 0; i < Object.keys(uslugi).length; i++) {
    const usluga = uslugi[i];
    uslugaElements.push({
        image_src: urlFor(usluga.image1).url(),
        price: usluga.price,
        title: usluga.small_title,
        question: usluga.question,
        body: usluga.paragraph1,
        href: `/usluga/${usluga._id}`
    });
  }
} else {
  uslugaElements.push('<p>Нет доступных товаров.</p>');
}
// console.log(uslugaElements)
---

{uslugaElements.map((elem) => {
    return (
        <Usluga
            image_src={elem.image_src}
            title={elem.title}
            price={elem.price}
            question={elem.question}
            body={elem.body}
            href={elem.href}
        />
    )
})}